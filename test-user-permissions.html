<!DOCTYPE html>
<html>
<head>
    <title>Test User Login with Limited Permissions</title>
</head>
<body>
    <h1>Test Login with Administration Role</h1>
    <button onclick="simulateLogin()">Simulate Login as Administration User</button>
    <button onclick="checkPermissions()">Check Current User Permissions</button>
    <button onclick="testSidebar()">Test Sidebar Filtering</button>
    <div id="result"></div>

    <script>
        // Simulate a user login with Administration role
        function simulateLogin() {
            const testUser = {
                name: 'Test Admin User',
                role: 'Administration', 
                email: 'testadmin@healthcare.com',
                permissions: ['Dashboard', 'Patient List'] // Only these two permissions
            };
            
            localStorage.setItem('healthcare_user', JSON.stringify(testUser));
            document.getElementById('result').innerHTML = 
                '<h3>‚úÖ User Logged In:</h3><pre>' + JSON.stringify(testUser, null, 2) + '</pre>';
        }

        function checkPermissions() {
            const userData = localStorage.getItem('healthcare_user');
            if (userData) {
                const user = JSON.parse(userData);
                document.getElementById('result').innerHTML = 
                    '<h3>Current User Permissions:</h3><pre>' + JSON.stringify(user, null, 2) + '</pre>';
            } else {
                document.getElementById('result').innerHTML = '<h3>‚ùå No user logged in</h3>';
            }
        }

        // Test the permission checking functions
        function testSidebar() {
            const userData = localStorage.getItem('healthcare_user');
            if (!userData) {
                document.getElementById('result').innerHTML = '<h3>‚ùå Please login first</h3>';
                return;
            }

            const user = JSON.parse(userData);
            
            // Test different pages
            const testPages = [
                '/dashboard',
                '/patients/list', 
                '/patients/add',
                '/management/staff',
                '/settings'
            ];

            let results = '<h3>üß™ Permission Test Results:</h3>';
            testPages.forEach(page => {
                // Simple permission check logic (mimicking the frontend)
                const hasAccess = user.permissions.includes('Dashboard') && page === '/dashboard' ||
                                 user.permissions.includes('Patient List') && page === '/patients/list' ||
                                 user.role === 'Admin' || user.role === 'admin'; // Admin override
                
                results += `<p>${page}: ${hasAccess ? '‚úÖ ALLOWED' : '‚ùå DENIED'}</p>`;
            });
            
            document.getElementById('result').innerHTML = results;
        }
    </script>
</body>
</html>
